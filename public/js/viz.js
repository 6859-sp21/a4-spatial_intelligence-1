viewof t = Scrubber(d3.ticks(0, 1, 200), {
    autoplay: false,
    loop: false,
    initial: 50,
    format: x => `t = ${x.toFixed(3)}`
  })
  
var w = window.innerWidth;
var h = 400;

var svg = d3.select("#line")
  .append("svg")
  .attr("width", w)
  .attr("height", h)
  .attr("id", "visualization");

var x = d3.scaleLinear().domain([0, 10]).range([0, w]);
var y = d3.scaleLinear().domain([0, 10]).range([10, h - 10]);

var line = d3.line()
.curve(d3.curveNatural)

var data = [[0., 0., 0.020240926742553712, 0.10962390899658203],[0.4192783355712891, 0.1981116400824653, 0.020240926742553712, 0.10962390899658203], [0.4185054302215576, 0.19994335174560546, 0.020243263244628905, 0.1114620632595486], [0.41936240196228025, 0.19906175401475695, 0.019310855865478517, 0.10654508802625869], [0.4186424255371094, 0.19245207044813367, 0.021800136566162108, 0.11359443664550781], [0.41831121444702146, 0.20131871965196396, 0.019907283782958984, 0.10190836588541667], [0.4187803268432617, 0.19999186197916666, 0.019444894790649415, 0.10455426110161675], [0.41925792694091796, 0.2018487294514974, 0.018691349029541015, 0.10233542124430338], [0.4182766914367676, 0.19857423570421007, 0.019907426834106446, 0.11079400380452474], [0.4184926986694336, 0.20003026326497395, 0.019823646545410155, 0.10887779659695096], [0.4181262493133545, 0.19986760881212023, 0.020430994033813477, 0.1063744862874349], [0.41793551445007326, 0.20129680633544922, 0.020710515975952148, 0.10569737752278646], [0.41778998374938964, 0.20091573927137588, 0.020508384704589842, 0.10714115566677518], [0.41744341850280764, 0.19996335771348742, 0.02114706039428711, 0.10868203904893663], [0.41796584129333497, 0.20063993665907118, 0.020908021926879884, 0.10364174313015408], [0.4184130668640137, 0.20462152693006727, 0.020438194274902344, 0.103049193488227], [0.41825160980224607, 0.2048066669040256, 0.020100164413452148, 0.10115540822347005], [0.41822042465209963, 0.2063544167412652, 0.019685029983520508, 0.0976642820570204], [0.41849842071533205, 0.2043243196275499, 0.01962432861328125, 0.10020133124457466], [0.41815524101257323, 0.2037579854329427, 0.02036447525024414, 0.1012139638264974], [0.4178521156311035, 0.20332118140326605, 0.020818758010864257, 0.10114178127712674], [0.41775169372558596, 0.19761852688259549, 0.020988082885742186, 0.1075685289171007], [0.4173858165740967, 0.20031939612494576, 0.02106633186340332, 0.10647400750054253], [0.41726250648498536, 0.19822512732611763, 0.021076297760009764, 0.10813441806369357], [0.4158305644989014, 0.19579255845811633, 0.021329212188720702, 0.10767866770426432], [0.4164136409759521, 0.1977399614122179, 0.020679521560668945, 0.10148696899414063], [0.41629624366760254, 0.19615658654106988, 0.021205329895019533, 0.10350858900282119], [0.41536774635314944, 0.19500418768988714, 0.022337627410888673, 0.10681400299072266], [0.41541099548339844, 0.19564024607340494, 0.021727561950683594, 0.10434936947292751], [0.415314769744873, 0.19578611585828992, 0.021965837478637694, 0.10422776540120443], [0.4154040336608887, 0.20178635915120444, 0.020563316345214844, 0.09406210581461588], [0.41571974754333496, 0.1985067367553711, 0.022446727752685545, 0.10022267235649956], [0.41708970069885254, 0.19916693369547525, 0.020719575881958007, 0.09699067009819878], [0.41695270538330076, 0.16560503641764324, 0.024593114852905273, 0.1305222405327691], [0.4110999584197998, 0.18523650699191624, 0.020626640319824217, 0.10021824306911892], [0.4100531578063965, 0.18120763566758896, 0.021429729461669923, 0.10502664777967664], [0.4100468158721924, 0.18153018951416017, 0.02233157157897949, 0.10507920583089193], [0.4086923122406006, 0.18393175337049697, 0.021271705627441406, 0.09964786105685763], [0.4085601806640625, 0.1880449718899197, 0.022171831130981444, 0.09673394097222222], [0.40887842178344724, 0.18854357401529948, 0.021575307846069335, 0.09550592634412977], [0.41597819328308105, 0.21176861657036675, 0.023101425170898436, 0.10730024973551432]]
  //adjust size (seems not working)
  for(i = 0;i < data.length;i++){  
    data[i] = data[i].map(x => x*1000)
  }
  console.log(data)


let repeat = () => {
    // clear the previously drawn line
//   svg.selectAll("path").remove();

  // Set a light grey class on old paths
  svg.selectAll("path").attr("class", "old");

  var path = svg.append("path")
    .attr("d", line(data))
    .attr("stroke", "darkgrey")
    .attr("stroke-width", "2")
    .attr("fill", "none");
    console.log(path);
  var totalLength = path.node().getTotalLength();

  path
    .attr("stroke-dasharray", totalLength + " " + totalLength)
    .attr("stroke-dashoffset", totalLength)
    .transition()
      .duration(8000)
      .ease(d3.easeLinear)
      .attr("stroke-dashoffset", 0)
      .on("end", repeat);
};
repeat();